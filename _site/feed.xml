<?xml version="1.0" encoding="UTF-8"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>Wonderings</title>
    <description>Articles on stuff, and sometimes things</description>
    <link>/</link>
    <atom:link href="/feed.xml" rel="self" type="application/rss+xml"/>
    <pubDate>Wed, 02 Sep 2015 01:35:26 -0400</pubDate>
    <lastBuildDate>Wed, 02 Sep 2015 01:35:26 -0400</lastBuildDate>
    <generator>Jekyll v2.4.0</generator>
    
      <item>
        <title>Yet Another Post About Diffie-Hellman</title>
        <description>&lt;h2 id=&quot;introduction&quot;&gt;Introduction&lt;/h2&gt;

&lt;p&gt;The problem of sharing a secret key over an insecure channel began receiving attention in the late 1960s, early 1970s, apparently first by the GCHQ and later by the academic cryptographic community.&lt;/p&gt;

&lt;p&gt;One solution is called the Diffie-Hellman key exchange. In this scheme, a secret key is constructed by two parties (traditionally Alice and Bob) communicating over an insecure channel.&lt;/p&gt;

&lt;p&gt;How is it possible to do this in the face of an adversary who is listening to the messages sent between Alice and Bob?&lt;br /&gt;
&lt;!--more--&gt;&lt;/p&gt;

&lt;h2 id=&quot;enter-the-galois-field&quot;&gt;Enter the Galois Field&lt;/h2&gt;

&lt;p&gt;The answer comes from, perhaps suprisingly, from number theory. Under proper conditions (to be discussed), it is believed to be prohibitively difficult to compute logarithms in the finite field GF(q). By exploiting this difficulty, we can share a key.&lt;/p&gt;

&lt;p&gt;But how does it work?&lt;/p&gt;

&lt;h2 id=&quot;the-process&quot;&gt;The Process&lt;/h2&gt;
&lt;p&gt;Let q be a prime and g be a generator for the finite field GF(q).&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;
    &lt;p&gt;Alice and Bob both generate random numbers a and b, respectively, chosen uniformly from  &lt;script type=&quot;math/tex&quot;&gt; \{1,2,...,q-1\} &lt;/script&gt; . These numbers are meant to be kept secret.&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;Alice computes  &lt;script type=&quot;math/tex&quot;&gt; Y_a = g^a \mod{q} &lt;/script&gt;  and Bob computes  &lt;script type=&quot;math/tex&quot;&gt; Y_b = g^b \mod{q} &lt;/script&gt; &lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;Alice and Bob exchange their Y’s computed in the last step, and compute their shared secret key:&lt;br /&gt;
 &lt;script type=&quot;math/tex&quot;&gt; k = Y_a^b = Y_b^a \mod{q} &lt;/script&gt; .&lt;/p&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;They may now use k as a key to encrypt their communications.&lt;/p&gt;

&lt;h2 id=&quot;what-makes-it-safe&quot;&gt;What Makes it Safe?&lt;/h2&gt;

&lt;p&gt;Suppose Eve is eavesdropping on Alice and Bob’s communication. Eve knows both &lt;script type=&quot;math/tex&quot;&gt;Y_a&lt;/script&gt;  and  &lt;script type=&quot;math/tex&quot;&gt;Y_b&lt;/script&gt; , in addition to q and g. In order for Eve to compute their secret key k, she must compute  &lt;script type=&quot;math/tex&quot;&gt;Y_a^{\log_g{Y_b}}\mod{q}&lt;/script&gt; . &lt;/p&gt;

&lt;p&gt;In the measured words of &lt;a href=&quot;https://ee.stanford.edu/~hellman/publications/24.pdf&quot;&gt;Diffie and Hellman&lt;/a&gt;,&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;“We thus see that if logs mod q are easily computed the sysstem can be broken. &lt;br /&gt;
While we do not currently have a proof of the converse (i.e., that the system is secure if logs mod q are difficult to compute), neither do we see any way to compute k from  &lt;script type=&quot;math/tex&quot;&gt;Y_a&lt;/script&gt;  and  &lt;script type=&quot;math/tex&quot;&gt;Y_b&lt;/script&gt;  without first obtaining either a or b [the randomly selected exponents of step 1].”&lt;/p&gt;
&lt;/blockquote&gt;

&lt;h2 id=&quot;but-is-it-really-safe&quot;&gt;But is it really safe?&lt;/h2&gt;

&lt;p&gt;The particular variant of the Diffie-Hellman protocol described above could be weak, depending on the chosen parameters. The TLS Logjam attack showed that keys generated with 512-bit primes could be bruteforced. &lt;/p&gt;

&lt;p&gt;One characteristic of a good prime number p is p-1 having large prime factors. In 1978, &lt;a href=&quot;https://www-ee.stanford.edu/~hellman/publications/28.pdf&quot;&gt;Pohlig and Hellman demonstrated&lt;/a&gt; an  &lt;script type=&quot;math/tex&quot;&gt;O(log^2{p})&lt;/script&gt;  algorithm for calculating discrete logarithms when p-1 has only small prime factors.&lt;/p&gt;

&lt;p&gt;The IETF has a &lt;a href=&quot;https://tools.ietf.org/html/rfc3526&quot;&gt;list&lt;/a&gt; of recommended prime number/generator pairs to use in Diffie-Hellman exchanges, although in light of the logjam attack, you should use &amp;gt;= 2048-bit primes only.&lt;/p&gt;

&lt;p&gt;These days, for maximum security, the protocol described above shouldn’t be used. Instead, you should use &lt;a href=&quot;https://en.wikipedia.org/wiki/Elliptic_curve_Diffie%E2%80%93Hellman&quot;&gt;elliptic curve Diffie-Hellman&lt;/a&gt;. Regardless, the original Diffie-Hellman algorithm is an important thing to learn from.&lt;/p&gt;

&lt;h2 id=&quot;implementation&quot;&gt;Implementation&lt;/h2&gt;

&lt;p&gt;If you wish to see an implementation in Racket, see this &lt;a href=&quot;https://gist.github.com/eu90h/9dd9c2a1051dedfd137e&quot;&gt;gist&lt;/a&gt;&lt;/p&gt;
</description>
        <pubDate>Tue, 01 Sep 2015 00:00:00 -0400</pubDate>
        <link>/articles/15/discrete-logs</link>
        <guid isPermaLink="true">/articles/15/discrete-logs</guid>
        
        
        <category>cryptography</category>
        
        <category>number-theory</category>
        
      </item>
    
  </channel>
</rss>
